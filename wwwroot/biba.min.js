function Controller(n){return function(t){Biba.inject(n,t)}}var Biba=function(){function n(t){var i=this;this.router=new BibaRouter;this.router.onRouteFinish(function(t){i.activatedController=n.activateController(t.currentRoute.path,t.element)});this.glboalController=t}return n.Start=function(t){var r=document.getElementsByTagName(t)[0],i=new XMLHttpRequest;i.open("Get","/app/start");i.onloadend=function(t){var i=JSON.parse(t.target.response);r.innerHTML=i.html;new n(n.activateController("*",r))};i.send()},n.inject=function(t,i){n._cache[t]=i},n._get=function(t){return n._cache[t]},n.activateController=function(t,i){var r=n._get(t),u;return r&&(u=new r(i)),u},n}();Biba._cache={};var Closure=function(){function n(){}return n}(),ViewController=function(){function n(n){this.element=n}return n}(),RouterResponse=function(){function n(){}return n}(),BibaRouter=function(){function n(){this.initRouterLinks()}return n.prototype.initRouterLinks=function(){for(var n,f,r,t=this,e=Array.prototype.slice.call(document.body.getElementsByTagName("*")),i=0,u=e;i<u.length;i++)n=u[i],f=n.attributes.getNamedItem("router-path"),f?(n.path=n.attributes.getNamedItem("router-path").value,n.attributes.removeNamedItem("router-path"),this.giveAnchorHandler(n)):n.attributes.getNamedItem("router-container")&&(this.routerContainer=n,this.routerContainer.attributes.removeNamedItem("router-container"));return this.routerContainer&&(document.dispatchEvent(new CustomEvent("onRouteStart",{detail:{path:location.pathname}})),r=location.pathname,this.getComponent(r).then(function(n){t.routerContainer.innerHTML=n;t.currentRoute={path:r};document.dispatchEvent(new CustomEvent("onRouteFinish",{detail:{currentRoute:t.currentRoute}}))})),{}},n.prototype.giveAnchorHandler=function(n){var t=this;n.onclick=function(n){return t.routerLinkClickHandler(n)}},n.prototype.routerLinkClickHandler=function(n){var i=this,t=n.target.path;return document.dispatchEvent(new CustomEvent("onRouteStart",{detail:{path:t}})),this.getComponent(t).then(function(n){i.routerContainer.innerHTML=n;t=t||"/";history.pushState({},document.title,t);i.currentRoute={path:t};document.dispatchEvent(new CustomEvent("onRouteFinish",{detail:{currentRoute:i.currentRoute,element:i.routerContainer}}))}).catch(console.error),!1},n.prototype.getComponent=function(n,t){return new Promise(function(i,r){var u=new XMLHttpRequest,f=("c/"+n).replace("//","/");u.open("POST",f,!0);u.onload=function(n){i(n.target.response)};u.onerror=function(n){r(n)};u.send(t||null)})},n.prototype.onRouteStart=function(n){document.addEventListener("onRouteStart",function(t){n(t.detail)},!1)},n.prototype.onRouteFinish=function(n){document.addEventListener("onRouteFinish",function(t){n(t.detail)},!1)},n}();